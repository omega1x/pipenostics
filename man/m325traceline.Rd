% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/m325traceline.R
\name{m325traceline}
\alias{m325traceline}
\title{Minenergo-325. Trace thermal-hydraulic regime for linear segment of district
 heating network}
\usage{
m325traceline(
  temperature = 130,
  pressure = mpa_kgf(6),
  flow_rate = 250,
  g = 0,
  a = 0,
  d = 711,
  wth = 12.7,
  len = c(600, 530, 300, 350),
  year = 1986,
  insulation = 0,
  laying = "underground",
  beta = FALSE,
  exp5k = TRUE,
  roughness = 0.006,
  inlet = 0,
  outlet = 0,
  elev_tol = 0.1,
  method = "romeo",
  forward = TRUE,
  absg = TRUE,
  strict_sizes = FALSE
)
}
\arguments{
\item{temperature}{\emph{Traced thermal hydraulic regime}. Sensor-measured temperature of heat
carrier (water)
inside the pipe sensor-measured at the inlet
(forward tracing) or at the outlet (backward tracing) of path, [\emph{°C}].
Type: \code{\link[checkmate]{assert_number}}.}

\item{pressure}{\emph{Traced thermal hydraulic regime}. Sensor-measured
\href{https://en.wikipedia.org/wiki/Pressure_measurement#Absolute}{absolute
pressure} of heat carrier (water) sensor-measured at the inlet
(forward tracing) or at the outlet (backward tracing) of path,
[\emph{MPa}].Type: \code{\link[checkmate]{assert_number}}.}

\item{flow_rate}{\emph{Traced thermal hydraulic regime}. Amount of heat carrier (water)
sensor-measured at the inlet (forward tracing) or at the outlet (backward
tracing) of path, [\emph{ton/h}].
Type: \code{\link[checkmate]{assert_number}}.}

\item{g}{amount of heat carrier discharge to network for each pipe segment in the
tracing path enumerated along the direction of flow. If flag \code{absg}
is \code{TRUE} then they treat argument \code{g} as absolute value in
[\emph{ton/h}], otherwise they do as percentage of flow_rate in the
pipe segment.
Type: \code{\link[checkmate]{assert_double}}.}

\item{a}{heat carrier (water) volume loss factor of cylindrical pipe,
[\emph{h⁻¹}]. Type: \code{\link[checkmate]{assert_double}}.}

\item{d}{nominal (outside) diameters of subsequent pipes in tracing path that are
enumerated along the direction of flow, [\emph{mm}].
Type: \code{\link[checkmate]{assert_double}}.}

\item{wth}{nominal wall thickness of pipe, [\emph{mm}].
Type: \code{\link[checkmate]{assert_double}}.}

\item{len}{length of subsequent pipes in tracing path that are enumerated
along the direction of flow, [\emph{m}].
Type: \code{\link[checkmate]{assert_double}}.}

\item{year}{year when pipe is put in operation after laying or total overhaul for
each pipe in tracing path enumerated along the direction of flow.
Type: \code{\link[checkmate]{assert_integerish}}.}

\item{insulation}{insulation that covers the exterior of pipe:
\describe{
  \item{\code{0}}{no insulation}
  \item{\code{1}}{foamed polyurethane or analogue}
  \item{\code{2}}{polymer concrete}
}
for each pipe in tracing path enumerated along the direction of flow.
Type: \code{\link[checkmate]{assert_numeric}} and
\code{\link[checkmate]{assert_subset}}.}

\item{laying}{type of pipe laying depicting the position of pipe in space:
\itemize{
  \item \code{air}
  \item \code{channel}
  \item \code{room}
  \item \code{tunnel}
  \item \code{underground}
}
for each pipe in tracing path enumerated along the direction of flow.
Type: \code{\link[checkmate]{assert_character}} and
\code{\link[checkmate]{assert_subset}}.}

\item{beta}{logical indicator: should they consider additional heat loss of fittings?
Logical value for each pipe in tracing path enumerated along the direction
of flow. Type: \code{\link[checkmate]{assert_logical}}.}

\item{exp5k}{logical indicator for regime of pipe: is pipe operated more that
\code{5000} hours per year? Logical value for each pipe in tracing path
enumerated along the direction of flow.
Type: \code{\link[checkmate]{assert_logical}}.}

\item{roughness}{roughness of internal wall for each pipe in tracing path enumerated along
the direction of flow, [\emph{m}].
Type: \code{\link[checkmate]{assert_double}}.}

\item{inlet}{elevation of pipe inlet for each pipe in tracing path enumerated along
the direction of flow, [\emph{m}].
Type: \code{\link[checkmate]{assert_double}}.}

\item{outlet}{elevation of pipe outlet for each pipe in tracing path enumerated along
the direction of flow, [\emph{m}].
Type: \code{\link[checkmate]{assert_double}}.}

\item{elev_tol}{maximum allowed discrepancy between adjacent outlet and inlet elevations of
two subsequent pipes in the traced path, [\emph{m}].
Type: \code{\link[checkmate]{assert_number}}.}

\item{method}{method of determining \emph{Darcy friction factor}
\itemize{
  \item \code{romeo}
  \item \code{vatankhah}
  \item \code{buzzelli}
}
Type: \code{\link[checkmate]{assert_choice}}. For more details see
\code{\link{dropp}}.}

\item{forward}{tracing direction flag: is it a forward direction of tracing?
If \code{FALSE} the backward tracing is performed.
Type: \code{\link[checkmate]{assert_flag}}.}

\item{absg}{whether argument \code{g} (amount of heat carrier discharge to network) is
an absolute value in [\emph{ton/h}] (\code{TRUE}) or is it a percentage
of flow rate in the pipe segment (\code{FALSE})?
Type: \code{\link[checkmate]{assert_flag}}.}

\item{strict_sizes}{verify diameter and wall thickness with the actual pipe specifications
produced. Type: \code{\link[checkmate]{assert_flag}}.}
}
\value{
A \code{\link{list}} containing results (detailed log) of tracing for each
  pipe in tracing path enumerated along the direction of flow:
  \describe{
    \item{\code{temperature}}{
      \emph{Traced thermal hydraulic regime}. Traced temperature of heat
       carrier (water), [\emph{°C}].
       Type: \code{\link[checkmate]{assert_double}}.
    }
    \item{\code{pressure}}{
      \emph{Traced thermal hydraulic regime}. Traced pressure of heat
       carrier (water) for each pipe in tracing path enumerated along the
       direction of flow, [\emph{MPa}].
       Type: \code{\link[checkmate]{assert_double}}.
    }
    \item{\code{flow_rate}}{
      \emph{Traced thermal hydraulic regime}. Traced flow rate of heat
       carrier (water) for each pipe in tracing path enumerated along the
       direction of flow, [\emph{ton/h}].
       Type: \code{\link[checkmate]{assert_double}}.
    }
    \item{\code{loss}}{
      \emph{Traced thermal hydraulic regime}. Normative specific heat
      loss power for each pipe in tracing path enumerated along the direction
      of flow, [\emph{kcal/m/h}].
      Type: \code{\link[checkmate]{assert_double}}.
    }
    \item{\code{flux}}{
      \emph{Traced thermal hydraulic regime}. Normative heat flux for each
      pipe in tracing path enumerated along the direction of flow,
      [\emph{W/m²}]. Type: \code{\link[checkmate]{assert_double}}.
    }
    \item{\code{Q}}{
      \emph{Traced thermal hydraulic regime}. Normative heat loss for each
      pipe in tracing path enumerated along the direction of flow per day,
      [\emph{kcal}]. Type: \code{\link[checkmate]{assert_double}}.
    }
  }
  Type: \code{\link[checkmate]{assert_list}}.
}
\description{
Trace values of thermal-hydraulic regime (temperature, pressure,
 flow_rate, and other) along the adjacent linear segments of pipeline using
 norms of heat loss values prescribed by
 \href{https://docs.cntd.ru/document/902148459}{Minenergo Order 325}.
}
\details{
They consider only simple tracing paths which do not contain rings and any
 kind of parallelization. At the same time bidirectional (forward and
 backward) tracing is possible in accordance with sensor position. They also
 may consider discharges to network at the inlet of each pipeline segment as
 an approximation of actual forks of flows.

 Relevant illustration of the adopted assumptions for 4-segment tracing path
 is depicted on the next figure.

 \figure{m325regtrace.png}

 They make additional check for consistency of \code{inlet} and \code{outlet}
 values for subsequent pipe segments. Discrepancy of appropriate elevations
 cannot be more than \code{elev_tol}.

 They also may consider some normative volume loss of heat carrier (water) by
 tuning volume loss factor \emph{a} in range \emph{0.0 -- 0.0025}
 \emph{h⁻¹}.

 Optional verification of pipe diameters and wall thicknesses is performed
 against \code{\link{b36pipedata}} data.
}
\examples{
library(pipenostics)

# Consider 4-segment tracing path depicted.
# First, let sensor readings for forward tracing:
t_fw <- 130  # [°C]
p_fw <- mpa_kgf(6) * all.equal(.588399, mpa_kgf(6))  # [MPa]
g_fw <- 250  # [ton/h]

# Let discharges to network for each pipeline segment are somehow determined
# as
discharges <- seq(0, 30, 10)  # [ton/h]

# Then the calculated regime (red squares) for forward tracing is
m325traceline(t_fw, p_fw, g_fw, discharges, forward = TRUE)

# Next consider values of traced regime as sensor readings for backward
# tracing:
t_bw <- 127.3367  # [°C]
p_bw <- .5870330  # [MPa]
g_bw <- 190  # [ton/h]

# Then the calculated regime (red squares) for backward tracing is
regime_bw <- m325traceline(t_bw, p_bw, g_bw, discharges, forward = FALSE)
print(regime_bw)

# Let compare sensor readings with backward tracing results:
with(regime_bw, {
  lambda <- function(val, constraint)
    c(val, constraint, constraint - val,
      abs(constraint - val) * 100/constraint)
  first <- 1
  structure(
    rbind(
      lambda(temperature[first], t_fw),
      lambda(pressure[first],    p_fw),
      lambda(flow_rate[first],   g_fw)
    ),
    dimnames = list(
      c("temperature", "pressure", "flow_rate"),
      c("sensor.value", "traced.value", "abs.discr", "rel.discr")
    )
  )
})

# To address the problem of possible norm losses of the heat carrier,
# they could roughly define the leaks as follows:

# * maximum value prescribed to heat carrier loss factor, [h⁻¹],
#   multiplied by heating season relative duration:
a <- 0.0025 * ( (365 - 90)/365 )

# * length of subsequent pipes, [m]:
l <- c(600, 530, 300, 350)

# * nominal (outside) diameters of subsequent pipes, [m]:
D <- rep.int(700, 4) * 1e-3

# * average year volumes of heat carrier (no heat carrier for 90 days in
#   summer), [m³]
V <- pi * D^2 / 4 * l

# * finally they get,  [ton/h]:
discharges <- a * V * drop(iapws::if97("rho", mpa_kgf(6), k_c(130))) * 1e-3

# * and the calculated regime (red squares) for forward tracing becomes
m325traceline(g = discharges, forward = TRUE)

# Let's compare it with more formal calculations:
m325traceline(a = a, forward = TRUE)

}
\seealso{
Other Regime tracing: 
\code{\link{dropg}()},
\code{\link{dropp}()},
\code{\link{dropt}()},
\code{\link{m325tracebw}()},
\code{\link{m325tracefw}()},
\code{\link{tracebw}()},
\code{\link{tracefw}()},
\code{\link{traceline}()}
}
\concept{Regime tracing}
